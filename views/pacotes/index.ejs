<%- include('../partials/head', { pageCSS: 'packages' }) %>

<%- include('../partials/header', { currentPage: 'pacotes' }) %>

<section class="packages-hero">
  <h1>Nossos Pacotes de Viagem</h1>
  <p>Descubra ofertas especiais para os destinos mais incr√≠veis do Brasil e do mundo</p>
</section>

<main class="packages-container">
  <!-- Filtros -->
  <section class="packages-filters">
    <a href="/pacotes" class="filter-chip <%= categoriaAtiva === 'todos' ? 'active' : '' %>">Todos</a>
    <a href="/pacotes?categoria=nacional" class="filter-chip <%= categoriaAtiva === 'nacional' ? 'active' : '' %>">Nacional</a>
    <a href="/pacotes?categoria=internacional" class="filter-chip <%= categoriaAtiva === 'internacional' ? 'active' : '' %>">Internacional</a>
    <a href="/pacotes?categoria=promocoes" class="filter-chip <%= categoriaAtiva === 'promocoes' ? 'active' : '' %>">Promo√ß√µes</a>
  </section>

  <!-- Grid de Pacotes -->
  <section class="packages-grid">
    <% pacotes.forEach(function(pacote) { %>
      <article class="package-card-detailed">
        <section class="package-image-large <%= pacote.bgClass %>">
          <% if (pacote.precoOriginal) { %>
            <section class="discount-badge">
              <%= Math.round(((parseFloat(pacote.precoOriginal) - parseFloat(pacote.preco)) / parseFloat(pacote.precoOriginal)) * 100) %>% OFF
            </section>
          <% } %>
          <% if (pacote.disponivel === false) { %>
            <section class="sold-out-overlay">
              <span class="sold-out-text">Esgotado</span>
            </section>
          <% } %>
        </section>
        
        <section class="package-content-detailed">
          <h3 class="package-title-large"><%= pacote.destino %></h3>
          <p class="package-period"><%= pacote.periodo %></p>
          <p class="package-description-detailed"><%= pacote.descricao %></p>
          
          <!-- Avalia√ß√£o -->
          <section class="package-rating">
            <section class="rating-stars">
              <% for(let i = 1; i <= 5; i++) { %>
                <% if (i <= Math.floor(pacote.avaliacao)) { %>
                  <span class="star filled">‚òÖ</span>
                <% } else if (i === Math.ceil(pacote.avaliacao) && pacote.avaliacao % 1 !== 0) { %>
                  <span class="star half">‚òÖ</span>
                <% } else { %>
                  <span class="star empty">‚òÜ</span>
                <% } %>
              <% } %>
            </section>
            <span class="rating-score">(<%= pacote.avaliacao %>/5)</span>
          </section>
          
          <!-- Pre√ßos -->
          <section class="package-pricing">
            <section class="price-info">
              <% if (pacote.precoOriginal) { %>
                <span class="price-original">R$ <%= pacote.precoOriginal %></span>
              <% } %>
              <section class="price-current">R$ <%= pacote.preco %></section>
              <span class="price-note">por pessoa</span>
            </section>
          </section>
          
          <section class="package-actions">
            <a href="/pacotes/<%= pacote.slug %>" class="btn-package-details">
              <span class="btn-icon">üëÅÔ∏è</span>
              Ver Detalhes Completos
            </a>
            <button class="btn-add-to-cart" 
                    data-pacote-id="<%= pacote.id %>"
                    data-pacote-nome="<%= pacote.destino %>"
                    data-pacote-preco="<%= pacote.preco %>"
                    data-pacote-periodo="<%= pacote.periodo %>"
                    data-pacote-imagem="<%= pacote.bgClass %>"
                    onclick="adicionarAoCarrinho(this)">
              <span class="btn-icon">üõí</span>
              Adicionar ao Carrinho
            </button>
          </section>
        </section>
      </article>
    <% }); %>
  </section>

  <!-- CTA Section -->
  <section class="packages-cta">
    <h2 class="cta-title">N√£o encontrou o que procurava?</h2>
    <p class="cta-description">Entre em contato conosco e criaremos um pacote personalizado especialmente para voc√™!</p>
    <a href="/contato" class="btn-cta">
      Falar com um Especialista
    </a>
  </section>
</main>

<%- include('../partials/footer') %>
<%- include('../partials/scripts') %>
<script src="/js/packages.js"></script>
